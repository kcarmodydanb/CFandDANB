CREATE OR REPLACE FORCE VIEW "VW_DANB_EXM_EXAM_AND_SECTION" ("EXAM_SERNO", "REGID", "CUST_ID", "EXAM_CD", "EXAM_SERIES_CD", "REVISION_NUMBER", "FORM_CD", "EXAM_TAKEN_DT", "SCORE", "GRADE", "EXAM_SCALED_SCORE", "SCALED_STATUS", "EXAM_SCORED_DT", "VUEID", "HOLD_FL", "SECTION_ORDINAL", "SECTION_SCALED_SCORE", "NOMINAL_RATING", "SECTION_NAME") AS 
  SELECT 
DANB_EXAM.EXAM_SERNO,
DANB_EXAM.REGID,
TRIM(LEADING '0' FROM substr(DANB_EXAM.CUST_ID,5)) as CUST_ID,
DANB_EXAM.EXAM_CD,
DANB_EXAM.EXAM_SERIES_CD,
DANB_EXAM.REVISION_NUMBER,
DANB_EXAM.FORM_CD, 
DANB_EXAM.EXAM_DT as EXAM_TAKEN_DT,
DANB_EXAM.SCORE,
DANB_EXAM.GRADE,
DANB_EXAM.SCALED_SCORE as EXAM_SCALED_SCORE,
DANB_EXAM.SCALED_STATUS,
DANB_EXAM.POST_DT AS EXAM_SCORED_DT,
DANB_EXAM.VUEID,
DANB_EXAM.HOLD_FL,
DANB_SECTION.SECTION_ORDINAL,
DANB_SECTION.SCALED_SCORE AS SECTION_SCALED_SCORE,
DANB_SECTION.NOMINAL_RATING,
DANB_SECTION.SECTION_NAME
FROM DANB_EXAM
INNER JOIN DANB_SECTION ON DANB_EXAM.EXAM_SERNO = DANB_SECTION.EXAM_SERNO

UNION ALL 

SELECT 
DANB_EXAM.EXAM_SERNO,
DANB_EXAM.REGID,
TRIM(LEADING '0' FROM substr(DANB_EXAM.CUST_ID,5)) as CUST_ID,
DANB_EXAM.EXAM_CD,
DANB_EXAM.EXAM_SERIES_CD,
DANB_EXAM.REVISION_NUMBER,
DANB_EXAM.FORM_CD, 
DANB_EXAM.EXAM_DT as EXAM_TAKEN_DT,
DANB_EXAM.SCORE,
DANB_EXAM.GRADE,
DANB_EXAM.SCALED_SCORE as EXAM_SCALED_SCORE,
DANB_EXAM.SCALED_STATUS,
DANB_EXAM.POST_DT AS EXAM_SCORED_DT,
DANB_EXAM.VUEID,
DANB_EXAM.HOLD_FL,
DANB_SECTIONVAR.SECTION_ORDINAL,
DANB_SECTIONVAR.SCALED_SCORE as SECTION_SCALED_SCORE,
DANB_SECTIONVAR.NOMINAL_RATING,
DANB_SECTION_DESCR.SECTION_DESCR
FROM DANB_EXAM
INNER JOIN DANB_SECTIONVAR ON DANB_EXAM.EXAM_SERNO = DANB_SECTIONVAR.EXAM_SERNO
INNER JOIN DANB_SECTION_DESCR ON DANB_EXAM.EXAM_SERIES_CD = DANB_SECTION_DESCR.EXAM_SERIES_CD
      AND DANB_SECTION_DESCR.REVISION_NUMBER = DANB_EXAM.REVISION_NUMBER
      AND DANB_SECTION_DESCR.FORM_CD = DANB_EXAM.FORM_CD
      AND DANB_SECTION_DESCR.SECTION_ORDINAL = DANB_SECTIONVAR.SECTION_ORDINAL
/
